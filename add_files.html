<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="3D Vista Dashboard" />
    <meta name="3D Vista" content="3D Vista Dashboard" />
    <meta name="generator" content="Hugo 0.84.0" />
    <title>3D Vista Dashboard</title>

    <!-- Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap"
      rel="stylesheet"
    />

    <!-- Bootstrap core CSS -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-GLhlTQ8iRABdZLl6O3oVMWSktQOp6b7In1Zl3/Jr59b6EGGoI1aFkw7cmDA6j6gD"
      crossorigin="anonymous"
    />

    <!-- Favicons -->
    <link
      rel="apple-touch-icon"
      href="/docs/5.0/assets/img/favicons/apple-touch-icon.png"
      sizes="180x180"
    />
    <link
      rel="icon"
      href="/docs/5.0/assets/img/favicons/favicon-32x32.png"
      sizes="32x32"
      type="image/png"
    />
    <link
      rel="icon"
      href="/docs/5.0/assets/img/favicons/favicon-16x16.png"
      sizes="16x16"
      type="image/png"
    />
    <link rel="manifest" href="/docs/5.0/assets/img/favicons/manifest.json" />
    <link
      rel="mask-icon"
      href="/docs/5.0/assets/img/favicons/safari-pinned-tab.svg"
      color="#7952b3"
    />
    <link rel="icon" href="/docs/5.0/assets/img/favicons/favicon.ico" />
    <meta name="theme-color" content="#7952b3" />

    <!-- Custom styles for this template -->
    <link href="css/main.css" rel="stylesheet" />
  </head>
  <body class="text-white v-dark bg-dark--image">
    <!-- HEADER -->
    <header class="main-header">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="col-auto col-logo">
            <a href="#" class="navbar-brand">
              <img src="images/logo-realtio--white.svg" />
            </a>
          </div>
          <div class="col-auto col-info">
            <div class="badge">TOUR 22 <img src="images/icon-view.svg" /></div>
          </div>
          <div class="col col-menu--item">
            <ul class="nav general-nav main-nav">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="#"
                  >INFORMATION</a
                >
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">PANORAMAS</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">PHOTOS</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">VIDEO</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">AGENT INFO</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">SKINS</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="#">PUBLISH</a>
              </li>
              <li class="nav-item">
                <button class="btn btn-icon" title="Share">
                  <span>
                    <svg
                      xmlns="http://www.w3.org/2000/svg"
                      width="12.617"
                      height="14"
                      viewBox="0 0 12.617 14"
                    >
                      <path
                        d="M2889.758,1563.26a2,2,0,0,1-2-1.995,1.841,1.841,0,0,1,.027-.289,1.551,1.551,0,0,1,.078-.306l-5.3-3.08a1.98,1.98,0,0,1-.648.481,1.8,1.8,0,0,1-.787.184,2,2,0,1,1,.77-3.832,2.1,2.1,0,0,1,.665.455l5.3-3.045a1.2,1.2,0,0,1-.078-.28,1.757,1.757,0,0,1-.027-.3,1.911,1.911,0,0,1,.587-1.417,2,2,0,0,1,2.826,2.826,1.912,1.912,0,0,1-1.418.586,2.357,2.357,0,0,1-.778-.131,1.493,1.493,0,0,1-.639-.429l-5.3,2.94a3.23,3.23,0,0,1,.062.324,2.336,2.336,0,0,1,.026.306,1.493,1.493,0,0,1-.026.263c-.018.093-.038.186-.062.28l5.3,3.01a2,2,0,0,1,1.417-.543,2,2,0,1,1,0,3.99Zm0-11.06a.927.927,0,1,0-.673-.271A.913.913,0,0,0,2889.758,1552.2Zm-8.627,5.005a.926.926,0,1,0-.674-.271A.915.915,0,0,0,2881.131,1557.2Zm8.627,5.005a.927.927,0,1,0-.673-.271A.913.913,0,0,0,2889.758,1562.21Z"
                        transform="translate(-2879.136 -1549.26)"
                      />
                    </svg>
                  </span>
                </button>
              </li>
            </ul>
          </div>
          <div class="col-auto col-user">
            <button class="btn btn-thumb btn-outline-light" title="New Tour">
              <span>
                <img src="images/user-thumb.svg" />
              </span>
              JOHN DOE
            </button>
          </div>
        </div>
      </div>
    </header>
    <!-- MAIN -->
    <main class="main-full">
      <div class="card card-upload">
        <div class="card-header">Upload your Panoramas</div>
        <div class="card-body">
          <form>
            <!-- Form -->
            <fieldset class="upload_dropZone text-center">
              <legend class="visually-hidden">Image uploader</legend>

              <img src="images/icon-upload.svg" class="mb-2" />

              <p>Drop files here</p>
              <div class="separator mb-3">
                <span>or</span>
              </div>

              <input
                id="upload_image_logo"
                data-post-name="image_logo"
                data-post-url="https://someplace.com/image/uploads/logos/"
                class="position-absolute invisible"
                type="file"
                multiple
                accept="image/jpeg, image/png, image/svg+xml"
              />

              <label class="btn btn-outline-light" for="upload_image_logo"
                >Browse Files</label
              >

              <div class="upload_gallery"></div>
            </fieldset>
            <!-- END Form -->
          </form>
        </div>
      </div>
    </main>
    <!-- Page Navigation dropup button -->
    <div class="dropdown btn-group--page-navigation">
      <button
        class="btn dropdown-toggle"
        type="button"
        id="input-a-03"
        data-bs-toggle="dropdown"
        aria-expanded="false"
      >
        Menu
      </button>
      <ul class="dropdown-menu" aria-labelledby="input-a-03">
        <li>
          <a class="dropdown-item" href="/register.html">Register</a>
        </li>
        <li>
          <a class="dropdown-item" href="/login.html">Login</a>
        </li>
        <li>
          <a class="dropdown-item" href="/index.html">Listado de items</a>
        </li>
        <li>
          <a class="dropdown-item" href="/add_files.html">AÃ±adir archivos</a>
        </li>
        <li>
          <a class="dropdown-item" href="/information.html">Informacion</a>
        </li>
        <li>
          <a class="dropdown-item" href="/panorama.html">Panorama</a>
        </li>
        <li>
          <a class="dropdown-item" href="/photos.html">Fotos</a>
        </li>
        <li>
          <a class="dropdown-item" href="/video.html">Video</a>
        </li>
        <li>
          <a class="dropdown-item" href="/user.html">Usuario</a>
        </li>
        <li>
          <a class="dropdown-item" href="/skins.html">Skins</a>
        </li>
        <li>
          <a class="dropdown-item" href="/publish_00.html">Publicar 00</a>
        </li>
        <li>
          <a class="dropdown-item" href="/publish_01.html">Publicar 01</a>
        </li>
        <li>
          <a class="dropdown-item" href="/publish_02.html">Publicar 02</a>
        </li>
        <li>
          <a class="dropdown-item" href="/publish_03.html">Publicar 03</a>
        </li>
        <li>
          <a class="dropdown-item" href="/audio.html">Audio (NEW)</a>
        </li>
      </ul>
    </div>
    <!-- END Page Navigation dropup button -->
  </body>
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-w76AqPfDkMBDXo30jS1Sgez6pr3x5MlQ1ZAGC+nuZB+EYdgRZgiwxhTBTkF7CXvN"
    crossorigin="anonymous"
  ></script>
  <!-- Jquery -->
  <script
    src="https://code.jquery.com/jquery-3.6.4.slim.min.js"
    integrity="sha256-a2yjHM4jnF9f54xUQakjZGaqYs/V1CYvWpoqZzC2/Bw="
    crossorigin="anonymous"
  ></script>
  <!-- flickity -->
  <script src="https://unpkg.com/flickity@2/dist/flickity.pkgd.min.js"></script>
  <script>
    /* Bootstrap 5 JS included */
    console.clear();
    ("use strict");

    // Drag and drop - single or multiple image files
    // https://www.smashingmagazine.com/2018/01/drag-drop-file-uploader-vanilla-js/
    // https://codepen.io/joezimjs/pen/yPWQbd?editors=1000
    (function () {
      "use strict";

      // Four objects of interest: drop zones, input elements, gallery elements, and the files.
      // dataRefs = {files: [image files], input: element ref, gallery: element ref}

      const preventDefaults = (event) => {
        event.preventDefault();
        event.stopPropagation();
      };

      const highlight = (event) => event.target.classList.add("highlight");

      const unhighlight = (event) => event.target.classList.remove("highlight");

      const getInputAndGalleryRefs = (element) => {
        const zone = element.closest(".upload_dropZone") || false;
        const gallery = zone.querySelector(".upload_gallery") || false;
        const input = zone.querySelector('input[type="file"]') || false;
        return { input: input, gallery: gallery };
      };

      const handleDrop = (event) => {
        const dataRefs = getInputAndGalleryRefs(event.target);
        dataRefs.files = event.dataTransfer.files;
        handleFiles(dataRefs);
      };

      const eventHandlers = (zone) => {
        const dataRefs = getInputAndGalleryRefs(zone);
        if (!dataRefs.input) return;

        // Prevent default drag behaviors
        ["dragenter", "dragover", "dragleave", "drop"].forEach((event) => {
          zone.addEventListener(event, preventDefaults, false);
          document.body.addEventListener(event, preventDefaults, false);
        });

        // Highlighting drop area when item is dragged over it
        ["dragenter", "dragover"].forEach((event) => {
          zone.addEventListener(event, highlight, false);
        });
        ["dragleave", "drop"].forEach((event) => {
          zone.addEventListener(event, unhighlight, false);
        });

        // Handle dropped files
        zone.addEventListener("drop", handleDrop, false);

        // Handle browse selected files
        dataRefs.input.addEventListener(
          "change",
          (event) => {
            dataRefs.files = event.target.files;
            handleFiles(dataRefs);
          },
          false
        );
      };

      // Initialise ALL dropzones
      const dropZones = document.querySelectorAll(".upload_dropZone");
      for (const zone of dropZones) {
        eventHandlers(zone);
      }

      // No 'image/gif' or PDF or webp allowed here, but it's up to your use case.
      // Double checks the input "accept" attribute
      const isImageFile = (file) =>
        ["image/jpeg", "image/png", "image/svg+xml"].includes(file.type);

      function previewFiles(dataRefs) {
        if (!dataRefs.gallery) return;
        for (const file of dataRefs.files) {
          let reader = new FileReader();
          reader.readAsDataURL(file);
          reader.onloadend = function () {
            let img = document.createElement("img");
            img.className = "upload_img mt-2";
            img.setAttribute("alt", file.name);
            img.src = reader.result;
            dataRefs.gallery.appendChild(img);
          };
        }
      }

      // Based on: https://flaviocopes.com/how-to-upload-files-fetch/
      const imageUpload = (dataRefs) => {
        // Multiple source routes, so double check validity
        if (!dataRefs.files || !dataRefs.input) return;

        const url = dataRefs.input.getAttribute("data-post-url");
        if (!url) return;

        const name = dataRefs.input.getAttribute("data-post-name");
        if (!name) return;

        const formData = new FormData();
        formData.append(name, dataRefs.files);

        fetch(url, {
          method: "POST",
          body: formData,
        })
          .then((response) => response.json())
          .then((data) => {
            console.log("posted: ", data);
            if (data.success === true) {
              previewFiles(dataRefs);
            } else {
              console.log("URL: ", url, "  name: ", name);
            }
          })
          .catch((error) => {
            console.error("errored: ", error);
          });
      };

      // Handle both selected and dropped files
      const handleFiles = (dataRefs) => {
        let files = [...dataRefs.files];

        // Remove unaccepted file types
        files = files.filter((item) => {
          if (!isImageFile(item)) {
            console.log("Not an image, ", item.type);
          }
          return isImageFile(item) ? item : null;
        });

        if (!files.length) return;
        dataRefs.files = files;

        previewFiles(dataRefs);
        imageUpload(dataRefs);
      };
    })();
  </script>
</html>
